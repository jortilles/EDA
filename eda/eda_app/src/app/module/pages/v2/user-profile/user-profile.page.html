<div class="container flex justify-center py-10 my-10 mx-auto px-4 bg-background rounded-lg">
  <div class="max-w-6xl space-y-6">
    <div>
      <h1 class="text-3xl font-bold tracking-tight" i18n="@@profileTitle">Perfil del usuario</h1>
      <p class="text-gray-500 dark:text-gray-400" i18n="@@profileSubtitle">
        Administra tu información personal y preferencias de cuenta
      </p>
    </div>
    
    <div class="h-px bg-gray-200 dark:bg-gray-700 w-full"></div>
    
    <div class="grid gap-6 md:grid-cols-2">
      <!-- Información Personal -->
      <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
        <div class="p-6">
          <h2 class="text-xl font-semibold" i18n="@@profileInfoTitle">Información Personal</h2>
          <p class="text-sm text-gray-500 dark:text-gray-400" i18n="@@profileInfoSubtitle">
            Actualiza tu información básica de perfil
          </p>
        </div>
        
        <div class="p-6 pt-0">
          <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="space-y-6">
            <div class="space-y-2">
              <label for="username" class="block text-sm font-medium" i18n="@@labelNombreUsuario">Nombre de usuario</label>
              <div class="flex items-center">
                <span class="mr-2 text-gray-500">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user">
                    <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg>
                </span>
                <input 
                  type="text" 
                  id="username" 
                  formControlName="username" 
                  class="flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#00BFB3] focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:ring-offset-gray-800 dark:placeholder:text-gray-400 dark:focus-visible:ring-[#00BFB3]"
                  placeholder="Tu nombre"
                >
              </div>
              @if (profileForm.get('username')?.invalid && profileForm.get('username')?.touched) {
                <p class="text-sm text-red-500" i18n="@@usernameLengthValidation">El nombre de usuario debe tener al menos 2 caracteres.</p>
              }
            </div>
            @if (!user.google) {
              <div class="space-y-2">
                <label for="email" class="block text-sm font-medium" i18n="@@labelUsuarioEmail">Correo electrónico</label>
                <div class="flex items-center">
                  <span class="mr-2 text-gray-500">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail">
                      <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                      <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
                    </svg>
                  </span>
                  <input 
                    type="email" 
                    id="email" 
                    formControlName="email" 
                    class="flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#00BFB3] focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:ring-offset-gray-800 dark:placeholder:text-gray-400 dark:focus-visible:ring-[#00BFB3]"
                    placeholder="tu@ejemplo.com"
                  >
                </div>
                @if (profileForm.get('email')?.invalid && profileForm.get('email')?.touched) {
                  <p class="text-sm text-red-500" i18n="@@emailValidation">Por favor ingresa un email válido.</p>
                }
              </div>
            }
            
            <div class="h-px bg-gray-200 dark:bg-gray-700 w-full"></div>
            
            <div class="space-y-4">
              <h3 class="text-lg font-medium" i18n="@@changePassword">Cambiar contraseña</h3>
              
              <div class="space-y-2">
                <label for="password" class="block text-sm font-medium" i18n="@@newPassword">Nueva contraseña</label>
                <input 
                  type="password" 
                  id="password" 
                  formControlName="password" 
                  class="flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#00BFB3] focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:ring-offset-gray-800 dark:placeholder:text-gray-400 dark:focus-visible:ring-[#00BFB3]"
                  placeholder="••••••••"
                >
              </div>
              
              <div class="space-y-2">
                <label for="confirmPassword" class="block text-sm font-medium" i18n="@@confirmNewPassword">Confirmar nueva contraseña</label>
                <input 
                  type="password" 
                  id="confirmPassword" 
                  formControlName="confirmPassword" 
                  class="flex h-10 w-full rounded-md border border-gray-200 bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#00BFB3] focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:ring-offset-gray-800 dark:placeholder:text-gray-400 dark:focus-visible:ring-[#00BFB3]"
                  placeholder="••••••••"
                >
                @if (profileForm.hasError('passwordMismatch')) {
                  <p class="text-sm text-red-500" i18n="@@passwordValidation">Las contraseñas no coinciden</p>
                }
              </div>
            </div>
            
            <button 
              type="submit" 
              class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#00BFB3] focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-gray-800 dark:focus-visible:ring-[#00BFB3] bg-[#00BFB3] text-white hover:bg-[#00BFB3]/90 h-10 px-4 py-2 w-full"
              [disabled]="profileForm.invalid"
            >
              <span i18n="@@saveChanges">Guardar cambios</span>
            </button>
          </form>
        </div>
      </div>

      <div class="space-y-6">
        <!-- Foto de perfil -->
        <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
          <div class="p-6">
            <h2 class="text-xl font-semibold" i18n="@@profileImage">Foto de perfil</h2>
            <p class="text-sm text-gray-500 dark:text-gray-400" i18n="@@profileImageSubtitle">
              Actualiza tu foto de perfil
            </p>
          </div>
          
          <div class="p-6 pt-0 flex flex-col items-center justify-center space-y-5">
            <div class="relative">
              <div class="h-40 w-40 rounded-full overflow-hidden flex items-center justify-center bg-gray-100 dark:bg-gray-700">
                @if (imageTemp) {
                  @if(profileImage() && (imageTemp!=='start')) {
                    <img [src]="profileImage()" alt="Foto de perfil" class="h-full w-full object-cover">
                  } @else {
                    <img [src]="profileImage() | image" alt="Foto de perfil" class="h-full w-full object-cover">
                  }
                } @else {
                  <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-400">
                    <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"></path>
                    <circle cx="12" cy="13" r="3"></circle>
                  </svg>
                }
              </div>
              <div class="absolute -bottom-2 -right-2">
                <label for="picture" class="cursor-pointer">
                  <div class="rounded-full bg-[#00BFB3] p-2 text-white shadow-sm hover:bg-[#00BFB3]/90">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-upload">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                  </div>
                  <span class="sr-only" i18n="@@uploadImage">Subir imagen</span>
                </label>
                <input
                  id="picture"
                  type="file"
                  accept="image/*"
                  class="hidden"
                  (change)="handleImageChange($event)"
                >
              </div>
            </div>
            <div class="text-center text-sm text-gray-500 dark:text-gray-400">
              {{ profileImage() ? selectedImage : noImageSelected }}
            </div>
            <button 
              (click)="handleImageUpload()" 
              class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#00BFB3] focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-gray-800 dark:focus-visible:ring-[#00BFB3] bg-[#00BFB3] text-white hover:bg-[#00BFB3]/90 h-10 px-4 py-2 w-full"
              [disabled]="!profileImage() || isUploading()"
            >
              {{ isUploading() ? "Subiendo..." : "Actualizar foto" }}
            </button>
          </div>
        </div>

        <!-- Preferencias de cuenta -->
        <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm">
          <div class="p-6">
            <h2 class="text-xl font-semibold" i18n="@@profilePreferences">Preferencias de cuenta</h2>
            <p class="text-sm text-gray-500 dark:text-gray-400" i18n="@@profileNotificationsPrefrences">
              Administra tus preferencias de notificaciones
            </p>
          </div>
          
          <div class="p-6 pt-0">
            <div class="border-b border-gray-200 dark:border-gray-700">
              <div class="flex space-x-2">
                <button 
                  class="px-4 py-2 text-sm font-medium border-b-2 transition-colors focus:outline-none"
                  [class.border-[#00BFB3]]="activeTab() === 'email'"
                  [class.text-[#00BFB3]]="activeTab() === 'email'"
                  [class.border-transparent]="activeTab() !== 'email'"
                  (click)="setActiveTab('email')"
                >
                  Email
                </button>
                <button 
                  class="px-4 py-2 text-sm font-medium border-b-2 transition-colors focus:outline-none"
                  [class.border-[#00BFB3]]="activeTab() === 'push'"
                  [class.text-[#00BFB3]]="activeTab() === 'push'"
                  [class.border-transparent]="activeTab() !== 'push'"
                  (click)="setActiveTab('push')"
                >
                  <span i18n="@@profileNotifications">Notificaciones</span>
                </button>
              </div>
            </div>
            
            @if (activeTab() === 'email') {
              <div class="space-y-4 pt-4">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="font-medium" i18n="@@profileUpdates">Actualizaciones</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400" i18n="@@profileUpdatesSubtitle">Recibe actualizaciones sobre nuevas funciones</p>
                  </div>
                  <button class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#00BFB3] focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-gray-800 dark:focus-visible:ring-[#00BFB3] border border-gray-200 bg-white hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:hover:bg-gray-700 h-9 px-3">
                    <span i18n="@@activated">Activado</span>
                  </button>
                </div>
                <div class="h-px bg-gray-200 dark:bg-gray-700 w-full"></div>
                <div class="flex items-center justify-between">
                  <div>
                    <p class="font-medium" i18n="@@newsletter">Boletín</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400" i18n="@@newsletterDescription">Recibe nuestro boletín mensual</p>
                  </div>
                  <button class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#00BFB3] focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-gray-800 dark:focus-visible:ring-[#00BFB3] border border-gray-200 bg-white hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:hover:bg-gray-700 h-9 px-3">
                    <span i18n="@@inactivated">Desactivado</span>
                  </button>
                </div>
              </div>
            }
            
            @if (activeTab() === 'push') {
              <div class="space-y-4 pt-4">
                <div class="flex items-center justify-between">
                  <div>
                    <p class="font-medium" i18n="@@profileMessages">Mensajes</p>
                    <p class="text-sm text-gray-500 dark:text-gray-400" i18n="@@profileMessagesDescription">Recibe notificaciones de nuevos mensajes</p>
                  </div>
                  <button class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#00BFB3] focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-gray-800 dark:focus-visible:ring-[#00BFB3] border border-gray-200 bg-white hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:hover:bg-gray-700 h-9 px-3">
                    <span i18n="@@activated">Activado</span>
                  </button>
                </div>
              </div>
            }
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

