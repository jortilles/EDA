<eda-dialog [inject]="dialog">
  <div body class="py-4">
    <form [formGroup]="form">
      <div class="grid grid-cols-3 gap-3">
        <p-dropdown [options]="targetTables" formControlName="targetTable" filter="true" optionLabel="label"
          i18n-placeholder="@@placeholderTargetTables" placeholder="tabla destino"
          id="eda_add_relation_targetTable" [style]="{'width': '100%'}">
        </p-dropdown>

        <p-dropdown [options]="sourceCols" formControlName="sourceCol" filter="true"
          optionLabel="display_name.default" i18n-placeholder="@@placeholderSourceColumns"
          placeholder="Columna origen" (onChange)="getColumnsByTable()" id="eda_add_relation_sourceCols" [style]="{'width': '100%'}">
        </p-dropdown>

        <p-dropdown [options]="targetCols" formControlName="targetCol" filter="true"
          i18n-placeholder="@@placeholderTargetColumns" placeholder="Columna destino "
          id="eda_add_relation_targetCol" [style]="{'width': '100%'}">
        </p-dropdown>
      </div>

      <button class="flex items-center mt-4 px-4 py-2 border rounded-md" (click)="addRelation()"
        [disabled]="!form.controls.targetTable.value  ||  !form.value.sourceCol || !form.value.targetCol ">
        <span i18n-label="@@addRelation">Añadir relación</span>
      </button>

      <div class="mt-4">
        <ul>
          <li *ngFor="let sourceCol of selectedSourceCols; let i=index">
            <i class="fa fa-close" style="color: #c0555e;"
              (click)="deleteRelation(i)">
            </i>
            &nbsp;&nbsp;
            {{controller.params.table.description}}.{{sourceCol.display_name.default}} ⇴
            {{targetTable}}.{{selectedTargetCols[i].display_name.default}}
          </li>
        </ul>
      </div>
    </form>
  </div>

  <div footer class="flex justify-end p-2 border-t gap-1.5">
    <button
      class="rounded-md px-4 py-2 border"
      (click)="closeDialog()"
      i18n="@@cancelarBtn">
      Cancelar
    </button>
    <button
      class="rounded-md px-4 py-2 bg-gradient-to-r from-[#00B0BA] to-teal-400 text-white"
      [disabled]="selectedSourceCols.length === 0"
      (click)="saveRelation()"
      i18n="@@guardarBtn">
      Confirmar
    </button>
  </div>
</eda-dialog>